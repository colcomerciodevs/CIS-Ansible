---
## Crear Grupo para restringir el acceso SSH
- name: Crear grupo ssh_access
  ansible.builtin.group:
    name: ssh_access
    state: present


# ------------------------------------------------------------
# ONPREMISE â†’ usuario tux
# ------------------------------------------------------------

- name: Verificar si existe el usuario tux
  ansible.builtin.command: id tux
  register: tux_id
  failed_when: false      # no revienta si el usuario no existe
  changed_when: false

- name: Agregar tux a ssh_access SOLO si existe
  ansible.builtin.user:
    name: tux
    groups: ssh_access
    append: true
  when:
    - tux_id.rc == 0


